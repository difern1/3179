{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "title": { "text": "Emissions Amounts by Type of Top 5 Countries" },
    "data": {
      "url": "https://raw.githubusercontent.com/difern1/3179/main/emissions.csv"
    },
    "transform": [
      {
        "calculate": "toNumber(datum.Total)",
        "as": "Total C02 Emissions(kT)"
      },
      {
        "sort": [{ "field": "Total C02 Emissions(kT)", "order": "descending" }],
        "window": [{"op": "row_number", "as": "rank"}],
        "frame": [null, null]
      },
      {
        "filter": "datum.rank > 1 && datum.rank < 7"
      },
      {
        "fold": ["Coal", "Gas", "Oil"],
        "as": ["EmissionType", "Value"]
      }
    ],
    "mark": "bar",
    "encoding": {
      "x": {
        "field": "EmissionType",
        "type": "nominal",
        "axis": {"title": "Emission Type"}
      },

      "y": {
        "field": "Value",
        "type": "quantitative",
        "axis": {"title": "Emission Amount"}
      },
      "color": {
        "field": "EmissionType",
        "type": "nominal",
        "legend": {"title": "Emission Type"}
        
      },
      "tooltip": [
        {"field":"Country","type":"nominal", "title":"Country"},
        {"field":"EmissionType","type":"nominal", "title":"Emission Type"},
        {"field":"Value","type":"quantitative", "title":"Amount in kT"}
      ],
      "column": {
        "field": "Country",
        "type": "nominal"
      }
    }
    
  }
  